<html>
<head>
    <title>四阶Adams PECE方法</title>
</head>
<body>
    <script>
        function func(_t,_y){
            if(Math.abs(_t-1)<1e-7) return -1.0;
	        return -(_y+1.0/_t)/_t-_y*_y;
        }
        function solu(_x){
            return -Math.tan(Math.log(_x)+Math.PI/4)/_x
        }

        var solution_appr=[],solution_real=[],inter_f=[];
        var N=100;
        
        var h=1/N,t=1,y=-1,y0,h2=h/2,h6=h/6,h24=h/24,k1,k2,k3,k4;
        solution_appr.push(-1); solution_real.push(-1); inter_f.push(1,-1);
        for(var i=0;i<3;i++){
            k1=func(t,y); k2=func(t+h2,y+h2*k1); k3=func(t+h2,y+h2*k2);
            t+=h; k4=func(t,y+h*k3); y=h6*(k1+2*k2+2*k3+k4)+y;
            solution_appr.push(y); solution_real.push(solu(t)); inter_f.push(func(t,y));
        }
        for(var i=3;i<N;i++){
            y0=y+h24*(55*inter_f[i]-59*inter_f[i-1]+37*inter_f[i-2]-9*inter_f[i-3]);
            t+=h; y=y+h24*(9*func(t,y0)+19*inter_f[i]-5*inter_f[i-1]+inter_f[i-2]);
            solution_appr.push(y); solution_real.push(solu(t)); inter_f.push(func(t,y));
        }

        for(var i=1;i<=N;i++) console.log(i.toString()+" "+String(solution_appr[i]-solution_real[i]));
    </script>
</body>
</html>